.. MAGEMin documentation

Problem definition
==================

Finding the most stable phase assemblage  is a challenging constrained optimization problem including both equality and inequality constraints. 

The Gibbs energy of a multi-component multiphase system is given by the weighted summation of the chemical potentials of all end-members and pure phases:

.. math::
   G_{sys} = \sum_{\lambda=1}^{\Lambda} n_{\lambda} \sum_{i=1}^{N_{\lambda}} \mu_{i}(\lambda) p_{i}(\lambda) + \sum_{\omega=1}^{\Omega} \mu_{\omega} n_{\omega}

where  

.. math:: 
   n_{\lambda} 
   
is the molar fraction of the solution phase.

.. math:: 
   p_{\lambda} 
   
is the molar fraction of the endmembers

.. math:: 
   n_{\omega} 
   
is the molar fraction of the pure phase.

The Gibbs energy of the system can alternatively be represented with respect to the chemical potentials [J.mol-1] and the number of moles [mol] of the system (Gibbs-Duhem constraint) for which there are C elements in the system.

.. math:: 
   G_{sys} = \sum_{j=1}^{C} \Gamma_{j} b_{j}

The chemical potential of a phase is either a constant for a condensed (pure) phase:

.. math:: 
   \mu_{i} = G_{i}^{0}

or a function for a phase within a solution:

.. math:: 
   \mu_{i} = G_{i}^{0} + RTln(a_{i}) + G_{i}^{ex}

where

.. math::
   a_{i}

is the thermochemical activity related to the mole fraction and the activity coefficient by

.. math::
   a_{i} = x_{i} \gamma_{i}


For the case of ideal mixing between the end-members, the activity coefficient is unity. The mixing of a species dissolved in a condensed phase, however rarely behaves ideally
and is typically a function of both temperature and composition (mixing-on-sites formulation).

The mass equality constraint is defined as

.. math::
   \sum_{\lambda=1}^{\Lambda} n_{\lambda} \sum_{i=1}^{N_{\lambda}} a_{ij}(\lambda) p_{i}(\lambda) + \sum_{\omega=1}^{\Omega} n_{\omega} a_{\omega j} - b_j = 0

where

.. math::
   a_{ij}
   
is the molar composition of component j in end-member i

and

.. math::
   a_{\omega j}
   
is the molar composition of component j in a pure phase

Minimization approach 
=====================

The Gibbs minimization approach employed in MAGEMin combines discretization of the equations of state in composition space with linear programming and extends the mass constrained Gibbs-hyperplane rotation method to account for the mixing-on-sites that takes place in silicate mineral solid solutions. For an exhaustive description of the methodology see Riel et (submitted). 

.. image:: /figs/GFE_intro.png
	:width: 800
	:align: center
